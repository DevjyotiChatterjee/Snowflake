--INITIALIZE THE VARIABLES
ALTER SESSION SET  WEEK_START = 0;
SET (START_DATE,END_DATE) = ('1980-01-01','2030-01-01');    /*Specify your start and end dates*/
SET NUM_OF_DAYS = (SELECT DATEDIFF(DAY, TO_DATE($START_DATE), TO_DATE($END_DATE)));


-- DATE DIMENSION GENERATOR
CREATE OR REPLACE TABLE DATE_DIMENSION 
as
WITH  DATE_DIM AS
(
SELECT
    ROW_NUMBER() OVER( ORDER BY SEQ4()) -1 AS  DATE_DIM_ID
    ,TO_DATE(DATEADD(DAY,DATE_DIM_ID, TO_DATE($START_DATE))) AS DATE
FROM
     TABLE(GENERATOR(ROWCOUNT => $NUM_OF_DAYS))
)
    SELECT CONCAT(DATE_DIM_ID+10,YEAR(DATE),TO_CHAR(DATE,'MM'),TO_CHAR(DATE,'DD')) AS DATE_SK
        , DATE
        , DECODE(DAYNAME(DATE),
                 'Mon','Monday', 
                 'Tue','Tuesday', 
                 'Wed', 'Wednesday', 
                 'Thu','Thursday',
                 'Fri', 'Friday', 
                 'Sat','Saturday', 
                 'Sun', 'Sunday')  AS DAY_NAME
        , DAYNAME(DATE) AS DAY_NAME_ABV
        , DAYOFWEEK(DATE) DAY_OF_WEEK
        , MONTH(DATE) AS MONTH_NUM
        , CONCAT(YEAR(DATE),TO_CHAR(DATE,'MM')) AS MONTH_ID
        , TO_CHAR(DATE,'MMMM') AS MONTH_NAME
        , MONTHNAME(DATE) AS MONTH_NAME_ABV
        , DATEADD(DAY, 1,LAST_DAY( DATEADD(MONTH,-1,DATE),MONTH)) as First_Day_Month
        , LAST_DAY(DATE, MONTH) LAST_DAY_MONTH
        , DATEDIFF(DAY, FIRST_DAY_Month, DATEADD(DAY, 1, DATE)) AS MONTH_TO_DATE 
        , QUARTER(DATE) AS QUARTER_NUM
        , CONCAT(YEAR(DATE),'Q',QUARTER(DATE)) AS QUARTER_ID
        , DATEADD(DAY, 1,LAST_DAY( DATEADD(QUARTER,-1,DATE),QUARTER)) as FIRST_DAY_QUARTER
        , LAST_DAY(DATE,QUARTER) AS LAST_DAY_QUARTER
        , DATEDIFF(DAY, FIRST_DAY_QUARTER, DATEADD(DAY, 1, DATE)) AS QUARTER_TO_DATE 
        , YEAR(DATE) AS YEAR
         FROM DATE_DIM;
